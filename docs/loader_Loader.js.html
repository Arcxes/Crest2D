<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: loader/Loader.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: loader/Loader.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>//Loader.js
//Author - Arcxes

/*
    Loader is designed to load assets of all kinds of assets by passing the data to a specific loader and managing the results
*/

//imports
import { ImageLoader } from "./ImageLoader";
import { JSONLoader } from "./JSONLoader";
import { AudioLoader } from "./AudioLoader";

//Loader Class
export class Loader {

    constructor() {
        /** amount of completed file loads */
        this.successCount = 0;
        /** amount of failed file loads */
        this.errorCount = 0;
        /** total amount of collected assets */
        this.totalAssets = 0;
        /** downloaded assets into the server */
        this.cache = {};
        /** assets waiting to be loaded */
        this.queue = [];
        /** function to load completed callbackS */
        this.callback = null;
        /** the image loader */
        this.imageLoader = new ImageLoader();
        /** the json loader */
        this.jsonLoader = new JSONLoader();
        /** the audio loader */
        this.audioLoader = new AudioLoader();
    }

    /**
     * set the Loader callback
     * @param {Function} callback 
     */
    setCallback(callback) {
        this.callback = callback;
    }

    /**
     * add an asset to be loaded
     * @param {string} url url to be queued
     */
    add(url) {
        this.totalAssets++;
        this.queue.push(url);
    }

    /**
     * load an asset
     * @param {string} url url to be loaded
     */
    load(url) {
        this.totalAssets++;
        let type = url.split(".");
        this.loadIntoMemory(url, type[1]);
    }

    /**
     * load all the queued assets
     * @param {Function} callback function to be called when assets are done loading
     */
    loadAssets(callback) {
        if (callback != undefined) {
            this.setCallback(callback);
        }
        if (this.isDone()) {
            this.callback();
        }
        for (let i in this.queue) {
            let url = this.queue[i];
            let type = url.split(".");
            this.loadIntoMemory(url, type[1]);
        }
    }

    /**
     * return the asset requested by its url
     * @param {string} url url of asset to retrieve
     * @return {*} asset that was retrieved
     */
    get(url) {
        return this.cache[url];
    }

    /**
     * pass the url and type to a specific loader to be loaded into memory
     * @param {string} url url to asset to load
     * @param {string} type type of asset to load
     */
    loadIntoMemory(url, type) {
        if (type == "png" || type == "jpg" || type == "jpeg") {
            this.imageLoader.load(url, this);
        } else if (type == "mp3" || type == "wav" || type == "ogg") {
            this.audioLoader.load(url, this);
        } else if (type == "json") {
            this.jsonLoader.load(url, this);
        } else {
            console.error(`Failed to load asset: { url: ${url}}`);
        }
    }

    /**
     * check if all the assets are done loading
     * @return {boolean} is the assets done loading
     */
    isDone() {
        if (this.totalAssets == this.successCount + this.errorCount) {
            this.totalAssets = 0;
            this.queue = [];
            return true;
        }
        return false;
    }
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Animation_Animation.html">Animation</a></li><li><a href="Camera_Camera.html">Camera</a></li><li><a href="Circle_Circle.html">Circle</a></li><li><a href="Client_Client.html">Client</a></li><li><a href="Display_Display.html">Display</a></li><li><a href="Rectangle_Rectangle.html">Rectangle</a></li><li><a href="SpriteSheet_SpriteSheet.html">SpriteSheet</a></li><li><a href="TiledMap_TiledMap.html">TiledMap</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.3</a> on Tue Jan 28 2020 18:41:49 GMT-0800 (Pacific Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
